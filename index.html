﻿<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arcade-Z | Tu Portal de Juegos</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Montserrat:wght@300;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --accent: #00f2ff;
            --bg-dark: #0a0a0c;
            --card-bg: #1a1a1e;
            --text: #ffffff;
            --gradient: linear-gradient(135deg, #00f2ff 0%, #0072ff 100%);
            /* Variables Arcade 3D */
            --neon-blue: #00f2ff;
            --neon-pink: #ff003c;
            --cabinet-main: #1a1a2e;
            --cabinet-dark: #111122;
        }

        body {
            margin: 0;
            font-family: 'Inter', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg-dark);
            color: var(--text);
            overflow-x: hidden;
        }

        /* --- CUSTOM SCROLLBAR --- */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #0a0a0c; }
        ::-webkit-scrollbar-thumb { background: var(--accent); border-radius: 5px; border: 2px solid #0a0a0c; }
        ::-webkit-scrollbar-thumb:hover { background: #fff; }

        /* --- RETRO SCANLINE EFFECT --- */
        body::after {
            content: ""; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 2px, 3px 100%; pointer-events: none; z-index: 9999;
        }

        /* --- NAVIGATION --- */
        nav {
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 50px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid var(--accent);
            position: sticky;
            top: 0;
            z-index: 100;
            backdrop-filter: blur(10px);
        }

        .logo {
            font-size: 28px;
            font-weight: 800;
            letter-spacing: -1px;
            background: var(--gradient);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-transform: uppercase;
            text-decoration: none;
        }

        .nav-links a {
            margin-left: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: 0.3s;
            text-decoration: none;
            color: var(--text);
        }

        .nav-links a:hover {
            color: var(--accent);
        }

        /* --- SEARCH BAR --- */
        .search-box {
            background: #222;
            border: 1px solid #333;
            border-radius: 20px;
            padding: 5px 15px;
            display: flex;
            align-items: center;
            margin: 0 20px;
            position: relative;
        }

        .search-box input {
            background: transparent;
            border: none;
            color: white;
            outline: none;
            padding: 5px;
            font-family: inherit;
        }
        /* --- SEARCH RESULTS DROPDOWN --- */
        .search-results-container {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: #1a1a1d;
            border: 1px solid #333;
            border-radius: 10px;
            margin-top: 5px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.8);
            z-index: 1000;
            display: none;
            overflow: hidden;
            max-height: 300px;
            overflow-y: auto;
        }

        .search-item {
            padding: 12px 15px; display: flex; align-items: center; gap: 10px;
            cursor: pointer; transition: 0.2s; text-decoration: none; color: white;
            border-bottom: 1px solid #222;
        }
        .search-item:hover { background: #333; padding-left: 20px; }
        .search-item:last-child { border-bottom: none; }
        .search-item i { width: 20px; text-align: center; color: var(--accent); }

        /* --- HERO SECTION --- */
        .hero {
            padding: 40px 50px;
            background: linear-gradient(rgba(0,0,0,0.5), rgba(10,10,12,1)), url('https://images.unsplash.com/photo-1550745165-9bc0b252726f?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            display: flex;
            align-items: center;
            justify-content: space-around;
            flex-wrap: wrap;
            min-height: 400px;
            position: relative;
            overflow: hidden;
        }

        .hero-text {
            max-width: 500px;
            text-align: left;
            position: relative;
            z-index: 2;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 242, 255, 0.5);
        }

        /* --- ARCADE 3D STYLES --- */
        .arcade-3d-wrapper {
            perspective: 1000px;
            padding: 20px;
            position: relative;
            z-index: 2;
        }

        .cabinet-3d {
            position: relative;
            width: 160px;
            height: 240px;
            transform: rotateY(-25deg) rotateX(5deg);
            transform-style: preserve-3d;
            transition: transform 0.5s ease;
            cursor: pointer;
        }

        .cabinet-3d:hover {
            transform: rotateY(-15deg) rotateX(0deg) scale(1.05);
        }

        .cabinet-front {
            position: absolute;
            width: 100%;
            height: 100%;
            background: var(--cabinet-main);
            transform: translateZ(40px);
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 2px solid #000;
            box-shadow: inset 0 0 20px #000;
        }

        .cabinet-top {
            position: absolute;
            width: 100%;
            height: 80px;
            background: var(--cabinet-dark);
            transform: rotateX(90deg) translateZ(40px);
        }

        .cabinet-side {
            position: absolute;
            width: 80px;
            height: 100%;
            background: linear-gradient(to bottom, var(--cabinet-main), var(--cabinet-dark));
            border: 2px solid #000;
            background-image: linear-gradient(45deg, transparent 40%, var(--neon-pink) 40%, var(--neon-pink) 45%, transparent 45%), linear-gradient(-45deg, transparent 40%, var(--neon-blue) 40%, var(--neon-blue) 45%, transparent 45%);
            background-size: 100% 100px;
        }

        .right {
            right: -40px;
            transform: rotateY(90deg);
        }

        .left {
            left: -40px;
            transform: rotateY(-90deg);
            display: none;
        }

        .marquee-pro {
            width: 100%; height: 40px;
            background: #000;
            border-bottom: 4px solid var(--cabinet-dark);
            box-shadow: inset 0 0 10px var(--neon-blue);
            display: flex; justify-content: center; align-items: center;
            transform: translateZ(5px);
        }

        .glitch-title {
            color: #fff; font-family: sans-serif; font-weight: 900; font-size: 16px;
            text-shadow: 2px 0 var(--neon-pink), -2px 0 var(--neon-blue);
        }

        .screen-container {
            width: 90%; height: 80px;
            background: #050505; border: 3px solid #333;
            position: relative; overflow: hidden;
        }

        .crt-lines {
            position: absolute; width: 100%; height: 100%;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }

        .control-panel {
            width: 100%; height: 30px;
            background: #222; margin-top: auto;
            display: flex; justify-content: space-around; align-items: center;
            border-top: 2px solid #444;
        }

        .stick {
            width: 10px; height: 10px;
            background: var(--neon-pink); border-radius: 50%;
            box-shadow: 0 0 10px var(--neon-pink);
        }

        .btns { display: flex; gap: 4px; }
        .b-red, .b-cyan { width: 8px; height: 8px; border-radius: 50%; }
        .b-red { background: var(--neon-pink); }
        .b-cyan { background: var(--neon-blue); }

        .bottom-part {
            width: 100%; height: 30px;
            display: flex; justify-content: center; align-items: center;
        }

        .coin-red {
            width: 10px; height: 15px;
            background: #000; border: 1px solid var(--neon-pink);
            box-shadow: 0 0 5px var(--neon-pink);
        }

        .floor-shadow {
            position: absolute; width: 120%; height: 20px;
            background: rgba(0, 0, 0, 0.6); bottom: -30px; left: -20%;
            filter: blur(15px); transform: rotateX(90deg);
        }

        /* --- GRID DE JUEGOS --- */
        .container {
            padding: 40px 50px;
        }

        .section-title {
            font-size: 24px;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
        }

        .section-title::before {
            content: '';
            width: 5px;
            height: 25px;
            background: var(--accent);
            margin-right: 15px;
            border-radius: 10px;
        }

        .game-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 25px;
        }

        .game-card {
            background: var(--card-bg);
            border-radius: 15px;
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            border: 1px solid #333;
            text-decoration: none;
            color: inherit;
            display: block;
            position: relative;
        }

        @keyframes border-pulse {
            0% { border-color: var(--accent); box-shadow: 0 0 5px var(--accent); }
            50% { border-color: #fff; box-shadow: 0 0 15px var(--accent), 0 0 5px #fff; }
            100% { border-color: var(--accent); box-shadow: 0 0 5px var(--accent); }
        }

        .game-card:hover {
            transform: translateY(-5px) scale(1.02);
            animation: border-pulse 1.5s infinite;
        }

        .game-tag {
            position: absolute; top: 10px; right: 10px;
            background: rgba(0,0,0,0.8); color: #ffd700;
            padding: 2px 8px; border-radius: 4px; font-size: 10px;
            font-weight: bold; border: 1px solid #ffd700;
            box-shadow: 0 0 5px #ffd700; z-index: 2;
        }

        .game-thumb {
            width: 100%;
            height: 120px;
            background: #333;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
        }

        .game-info {
            padding: 15px;
        }

        .game-title {
            font-weight: bold;
            font-size: 16px;
        }

        /* --- NUEVOS TIPOS DE TARJETA --- */
        #featured-game-container { margin-bottom: 40px; }
        .game-card-large {
            display: block; text-decoration: none; color: white;
            background: var(--card-bg); border-radius: 15px;
            border: 1px solid #333; overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .game-card-large:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 242, 255, 0.2);
            border-color: var(--accent);
        }
        .game-thumb-large {
            height: 250px; background-size: cover; background-position: center;
            display: flex; align-items: flex-end; padding: 20px;
        }
        .large-card-title { font-size: 28px; font-weight: 800; text-shadow: 0 2px 10px #000; }
        .game-info-large { padding: 20px; display: flex; justify-content: space-between; align-items: center; }
        .game-info-large p { margin: 0; color: #aaa; }
        .play-now-btn { background: var(--accent); color: #000; padding: 10px 20px; border-radius: 8px; font-weight: bold; }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        .category-card {
            display: flex; align-items: center; gap: 20px;
            background: var(--card-bg); border-radius: 12px;
            padding: 20px; text-decoration: none; color: white; cursor: pointer;
            border: 1px solid #333; transition: 0.3s;
        }
        .category-card:hover {
            border-color: var(--cat-color, var(--accent));
            transform: scale(1.03);
        }
        .cat-icon {
            font-size: 30px; width: 60px; height: 60px;
            background: linear-gradient(45deg, var(--cat-color, var(--accent)), #333);
            border-radius: 10px; display: flex; justify-content: center; align-items: center;
        }
        .cat-name { font-size: 18px; font-weight: 600; }

        /* --- ANIMACIONES --- */
        @keyframes slideDown {
            from { transform: translateY(-100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        nav { animation: slideDown 0.8s ease-out; }
        .hero-text { animation: fadeInUp 1s ease-out 0.2s backwards; }
        .arcade-3d-wrapper { animation: float 6s ease-in-out infinite; }
        
        .game-card { opacity: 0; animation: fadeInUp 0.6s ease-out forwards; }

        .cta-button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 20px var(--accent);
        }

        /* --- PARTICLES --- */
        #particles-canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
            pointer-events: none;
        }

        /* --- NAVBAR PROFILE --- */
        .nav-profile-container {
            display: flex;
            align-items: center;
            gap: 15px;
            background: rgba(255, 255, 255, 0.05);
            padding: 5px 15px 5px 20px;
            border-radius: 30px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: 0.3s;
            cursor: pointer;
            margin-left: 20px;
        }
        .nav-profile-container:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent);
        }
        .nav-user-name {
            font-weight: 700; font-size: 14px; color: white; letter-spacing: 0.5px;
        }
        #nav-avatar {
            border-radius: 50%; border: 2px solid var(--accent);
            background: #111; box-shadow: 0 0 10px rgba(0, 242, 255, 0.2);
        }

        /* --- PREMIUM VIEW STYLES --- */
        #premium-view {
            padding: 40px 20px;
            max-width: 1200px;
            margin: 0 auto;
            color: white;
            animation: fadeInUp 0.5s ease-out;
            font-family: 'Montserrat', sans-serif;
        }
        .premium-header {
            text-align: center; margin-bottom: 60px;
            background: radial-gradient(circle at center, rgba(255, 215, 0, 0.15) 0%, rgba(0,0,0,0) 70%);
            padding: 60px 20px; border-radius: 20px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.2);
            position: relative;
        }
        .premium-title { 
            font-family: 'Cinzel', serif; 
            font-size: 60px; 
            background: linear-gradient(to bottom, #ffd700, #f1c40f, #b8860b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0; 
            letter-spacing: 2px;
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.4));
        }
        .premium-price { font-size: 20px; color: #ddd; margin-top: 15px; font-weight: 300; letter-spacing: 1px; }
        
        .buy-btn {
            background: linear-gradient(135deg, #ffd700 0%, #b8860b 100%);
            border: 1px solid #ffd700; padding: 18px 60px; font-size: 18px; font-weight: 700;
            color: #000; border-radius: 30px; cursor: pointer; margin-top: 20px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3); transition: all 0.3s ease;
            font-family: 'Montserrat', sans-serif; text-transform: uppercase; letter-spacing: 1px;
            position: relative; overflow: hidden;
        }
        .buy-btn::after {
            content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
            background: linear-gradient(to right, transparent, rgba(255,255,255,0.4), transparent);
            transform: rotate(45deg); transition: 0.5s; opacity: 0;
        }
        .buy-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 50px rgba(255, 215, 0, 0.5); }
        .buy-btn:hover::after { left: 100%; opacity: 1; transition: 0.5s; }
        .buy-btn:disabled { background: #555; color: #888; cursor: not-allowed; box-shadow: none; }

        .premium-subtitle {
            font-family: 'Cinzel', serif; text-align: center; font-size: 30px; color: white; margin-bottom: 40px;
            position: relative; display: inline-block; left: 50%; transform: translateX(-50%);
        }
        .premium-subtitle::after {
            content: ''; position: absolute; bottom: -10px; left: 20%; width: 60%; height: 2px;
            background: linear-gradient(90deg, transparent, #ffd700, transparent);
        }

        .benefits-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px; margin-top: 20px;
        }
        .benefit-item {
            background: rgba(20, 20, 25, 0.6); padding: 20px; border-radius: 12px;
            display: flex; align-items: center; gap: 15px; font-size: 14px;
            border: 1px solid rgba(255, 215, 0, 0.1);
            transition: 0.3s; backdrop-filter: blur(5px);
        }
        .benefit-item:hover {
            background: rgba(255, 215, 0, 0.1);
            border-color: rgba(255, 215, 0, 0.4);
            transform: translateX(5px);
        }
        .benefit-item i { 
            color: #ffd700; font-size: 18px; width: 30px; text-align: center;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .balance-display {
            background: rgba(0,0,0,0.6); padding: 10px 25px; border-radius: 50px;
            border: 1px solid #444; display: inline-block; margin-top: 25px;
            font-family: 'Fira Code', monospace; font-size: 14px;
        }

        /* Animación de entrada escalonada */
        .benefit-item { opacity: 0; animation: slideInLeft 0.5s ease-out forwards; }
        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
    </style>
    <script src="src/js/avatar.js"></script>
</head>
<body>

    <nav>
        <a href="#" class="logo" onclick="showApp()">Arcade-Z</a>
        <div class="nav-links">
            <a href="src/html/profile.html">Perfil</a>
            <a href="#juegos" onclick="showApp()">Populares</a>
            <a href="#" onclick="showPremium()" style="background: var(--gradient); padding: 8px 15px; border-radius: 20px;">Premium</a>
        </div>
        <div class="search-box">
            <i class="fa-solid fa-magnifying-glass" style="color:#888"></i>
            <input type="text" id="global-search" placeholder="Buscar juegos..." autocomplete="off">
            <div id="search-results" class="search-results-container"></div>
        </div>
        <div class="nav-profile-container" onclick="window.location.href='src/html/profile.html'">
            <span class="nav-user-name">JUGADOR</span>
            <canvas id="nav-avatar" width="40" height="40"></canvas>
        </div>
    </nav>
    <script src="src/js/global.js"></script>
	<div id="cookie-banner" class="cookie-box">
        <!-- Cookie content -->
    <div class="cookie-content">
        <p>🎮 <b>Control de Misión:</b> Usamos cookies para guardar tus récords y mejorar tu experiencia en Arcade-Z. ¿Aceptas el desafío?</p>
        <div class="cookie-btns">
            <button onclick="acceptCookies()" class="cookie-btn accept">ACEPTAR</button>
            <button onclick="acceptCookies()" class="cookie-btn close">CERRAR</button>
        </div>
    </div>
</div>

<style>
    .cookie-box {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #1a1a1d;
        border: 2px solid var(--accent);
        border-radius: 12px;
        padding: 20px;
        z-index: 9999;
        width: 90%;
        max-width: 500px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.8), 0 0 20px rgba(50, 255, 126, 0.2);
        display: none; /* Se activa con JS */
    }

    .cookie-content {
        display: flex;
        flex-direction: column;
        align-items: center;
        text-align: center;
        gap: 15px;
    }

    .cookie-btns { display: flex; gap: 10px; }

    .cookie-btn {
        padding: 10px 25px;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        border: none;
        transition: 0.3s;
    }

    .accept { background: var(--accent); color: #000; }
    .accept:hover { background: #fff; transform: scale(1.05); }
    .close { background: #333; color: #fff; }

    @keyframes slideUp {
        from { bottom: -100px; opacity: 0; }
        to { bottom: 20px; opacity: 1; }
    }
</style>

<script>
    // Mostrar banner si no han aceptado
    if (!localStorage.getItem('cookies-aceptadas')) {
        const banner = document.getElementById('cookie-banner');
        banner.style.display = 'block';
        banner.style.animation = 'slideUp 0.5s forwards';
    }

    function acceptCookies() {
        localStorage.setItem('cookies-aceptadas', 'true');
        document.getElementById('cookie-banner').style.display = 'none';
        // Esto ayuda a desbloquear el audio del juego
        if (typeof resumeAudio === "function") resumeAudio();
    }
</script>

    <!-- VISTA PRINCIPAL (APP) -->
    <div id="app-view">
    <div class="hero">
        <canvas id="particles-canvas"></canvas>
        <div class="hero-text">
            <h1>¡Bienvenido a la Zona Z!</h1>
            <p>Los mejores juegos HTML5 sin descargas. Sumérgete en el arcade del futuro.</p>
            <a href="#juegos" class="cta-button" style="display:inline-block; margin-top:20px; padding:10px 25px; background:var(--accent); color:#000; text-decoration:none; font-weight:bold; border-radius:5px; transition: 0.3s;">JUGAR AHORA</a>
        </div>
        
        <!-- 3D ARCADE INTEGRATION -->
        <div class="arcade-3d-wrapper">
            <div class="cabinet-3d" onclick="document.getElementById('juegos').scrollIntoView({ behavior: 'smooth' });">
                <div class="cabinet-top"></div>
                <div class="cabinet-front"></div>
                <div class="cabinet-side left"></div>
                <div class="cabinet-side right"></div>
                <div class="floor-shadow"></div>
            </div>
        </div>
    </div>

    <div class="container" id="juegos">
        <div class="section-title">Tu juego más jugado:</div>
        <div id="featured-game-container">
            <!-- La tarjeta grande se cargará aquí -->
        </div>

        <div class="section-title">Juegos Tendencia</div>
        <div class="game-grid">
            <!-- Las tarjetas de juego se cargarán aquí desde global.js -->
        </div>

        <div class="section-title" style="margin-top: 40px;">Explorar por Categoría</div>
        <div class="category-grid">
            <!-- Las categorías se cargarán aquí -->
        </div>
    </div>
    </div>

    <!-- VISTA PREMIUM (OCULTA) -->
    <div id="premium-view" style="display: none;">
        <div class="premium-header">
            <h1 class="premium-title">ARCADE-Z PREMIUM</h1>
            <p class="premium-price">LA EXPERIENCIA DEFINITIVA PARA JUGADORES DE ÉLITE</p>
            
            <div id="premium-status-area">
                <!-- Se llena con JS -->
            </div>
            
            <div class="balance-display">
                SALDO ACTUAL: <span id="user-zcoins" style="color: #ffd700; font-weight: bold;">0</span> 🪙
            </div>
        </div>

        <h2 class="premium-subtitle">VENTAJAS EXCLUSIVAS</h2>
        <div class="benefits-grid" id="benefits-list"></div>
    </div>

    <script>
        // Sistema de Partículas
        const canvas = document.getElementById('particles-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = canvas.parentElement.offsetWidth;
        canvas.height = canvas.parentElement.offsetHeight;

        let particles = [];
        class Particle {
            constructor() {
                this.x = Math.random() * canvas.width;
                this.y = Math.random() * canvas.height;
                this.size = Math.random() * 2 + 0.5;
                this.speedX = Math.random() * 1 - 0.5;
                this.speedY = Math.random() * 1 - 0.5;
                this.color = Math.random() > 0.5 ? '#00f2ff' : '#ff003c';
            }
            update() {
                this.x += this.speedX;
                this.y += this.speedY;
                if (this.size > 0.2) this.size -= 0.01;
                if (this.size <= 0.2 || this.x < 0 || this.x > canvas.width || this.y < 0 || this.y > canvas.height) {
                    this.x = Math.random() * canvas.width;
                    this.y = Math.random() * canvas.height;
                    this.size = Math.random() * 2 + 1;
                }
            }
            draw() {
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        for (let i = 0; i < 50; i++) particles.push(new Particle());

        function animateParticles() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            particles.forEach(p => { p.update(); p.draw(); });
            requestAnimationFrame(animateParticles);
        }
        animateParticles();

        // --- PROFILE & AVATAR LOADER ---
        document.addEventListener('DOMContentLoaded', () => {
            // Cargar datos del perfil
            const loadedProfile = JSON.parse(localStorage.getItem('arcadeProfile')) || { name: 'JUGADOR' };
            const loadedAvatar = JSON.parse(localStorage.getItem('arcadeAvatar')) || { color: '#222', icon: 'robot' };
            
            // Actualizar nombre
            const nameEl = document.querySelector('.nav-user-name');
            if(nameEl) nameEl.textContent = loadedProfile.name;

            // Renderizar Avatar
            const canvas = document.getElementById('nav-avatar');
            if(canvas) {
                let animId;
                function animate() {
                    renderAvatar(canvas, loadedAvatar, Date.now(), null, [], 'happy');
                    animId = requestAnimationFrame(animate);
                }
                animate();
            }
        });

        // Lógica de Búsqueda Estilo YouTube
        const searchInput = document.getElementById('global-search');
        const searchResults = document.getElementById('search-results');

        searchInput.addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            if (term.length < 1) {
                searchResults.style.display = 'none';
                return;
            }

            const matches = gamesDB.filter(g => g.title.toLowerCase().includes(term) || g.category.toLowerCase().includes(term));
            
            if (matches.length > 0) {
                searchResults.innerHTML = matches.map(g => `
                    <a href="${g.path + g.url}" class="search-item">
                        <i class="${g.iconClass || 'fa-solid fa-gamepad'}"></i>
                        <span>${g.title}</span>
                        <span style="font-size:12px; color:#666; margin-left:auto;">${g.category}</span>
                    </a>
                `).join('');
                searchResults.style.display = 'block';
            } else {
                searchResults.style.display = 'none';
            }
        });

        // Cerrar búsqueda al hacer click fuera
        document.addEventListener('click', (e) => {
            if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
                searchResults.style.display = 'none';
            }
        });

        // Easter Egg (Konami Code)
        const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];
        let konamiIndex = 0;
        document.addEventListener('keydown', (e) => {
            if (e.key === konamiCode[konamiIndex]) {
                konamiIndex++;
                if (konamiIndex === konamiCode.length) {
                    konamiIndex = 0;
                    // Efecto Glitch y Colores
                    document.body.style.transition = 'filter 0.5s';
                    document.body.style.filter = 'invert(1) hue-rotate(180deg)';
                    document.body.style.animation = 'glitch 0.2s infinite';
                    
                    // Mensaje Secreto
                    const msg = document.createElement('div');
                    msg.innerText = "CHEAT CODE ACTIVATED: GOD MODE";
                    msg.style.cssText = "position:fixed; top:50%; left:50%; transform:translate(-50%, -50%); font-size:50px; font-weight:900; color:#0f0; text-shadow:0 0 20px #0f0; z-index:9999; font-family:monospace;";
                    document.body.appendChild(msg);

                    setTimeout(() => {
                        document.body.style.filter = 'none';
                        document.body.style.animation = 'none';
                        msg.remove();
                    }, 2000);
                }
            } else {
                konamiIndex = 0;
            }
        });

        // --- PREMIUM SYSTEM LOGIC ---
        const appView = document.getElementById('app-view');
        const premiumView = document.getElementById('premium-view');
        const benefitsList = document.getElementById('benefits-list');
        const statusArea = document.getElementById('premium-status-area');
        const zcoinsDisplay = document.getElementById('user-zcoins');

        function showApp() {
            appView.style.display = 'block';
            premiumView.style.display = 'none';
            window.scrollTo(0,0);
        }

        function showPremium() {
            appView.style.display = 'none';
            premiumView.style.display = 'block';
            updatePremiumUI();
            window.scrollTo(0,0);
        }

        function updatePremiumUI() {
            const profile = JSON.parse(localStorage.getItem('arcadeProfile')) || { zCoins: 0, isPremium: false };
            zcoinsDisplay.innerText = profile.zCoins;

            if (profile.isPremium) {
                statusArea.innerHTML = `
                    <div style="font-size: 24px; color: #32ff7e; margin: 30px 0; font-weight: bold; text-shadow: 0 0 15px #32ff7e;">
                        <i class="fa-solid fa-check-circle"></i> MEMBRESÍA ACTIVA
                    </div>
                    <p style="color: #aaa; font-size: 14px;">Gracias por apoyar Arcade-Z. Tu estatus de leyenda está activo.</p>
                `;
            } else {
                const canAfford = profile.zCoins >= 500;
                statusArea.innerHTML = `
                    <p style="color: #ccc; max-width: 600px; margin: 0 auto 30px; line-height: 1.6;">
                        Desbloquea todas las funciones, elimina límites y destaca entre la multitud. 
                        <br><span style="color:#888; font-size:12px;">(Gana ZCoins jugando: 1 ZCoin cada 10 segundos)</span>
                    </p>
                    <button class="buy-btn" onclick="buyPremium()" ${canAfford ? '' : 'disabled'}>
                        ${canAfford ? 'DESBLOQUEAR AHORA - 500 🪙' : `TE FALTAN ${500 - profile.zCoins} 🪙`}
                    </button>
                `;
            }

            // Generar lista de ventajas si está vacía
            if (benefitsList.children.length === 0) {
                const benefits = [
                    "Sin anuncios (Simulado)", "Insignia Dorada en Perfil", 
                    "2x XP en todos los juegos", "2x ZCoins los fines de semana", "Acceso anticipado a Betas",
                    "Torneos Exclusivos", "Skin Dorada en Space Defense",
                    "Balón de Oro en Z-Soccer", "Avatar Marco Premium", 
                    "Estadísticas Detalladas", "Modo Teatro Automático", "Guardado en Nube (Simulado)",
                    "Logros Secretos Visibles", 
                    "Efectos de partículas en perfil", "Título 'Leyenda' desbloqueado", "Borde de Avatar Animado",
                    "Regalos diarios de XP", "Fondo de perfil personalizado",
                    "Música de menú seleccionable", "Historial de partidas extendido", "Replay de partidas (Beta)",
                    "Prioridad en matchmaking", "Ranuras de guardado extra", 
                    "Acceso a juegos Legacy", "Insignia de Fundador (Tiempo Limitado)", 
                    "Creación de Clanes", "Desafíos semanales extra",
                    "Multiplicador de combo x1.5", "Vidas extra en juegos Arcade", "Continues infinitos",
                    "Badge en Leaderboards"
                ];
                
                benefitsList.innerHTML = benefits.map((b, i) => `
                    <div class="benefit-item" style="animation-delay: ${i * 0.02}s">
                        <i class="fa-solid fa-crown"></i> ${b}
                    </div>
                `).join('');
            }
        }

        function buyPremium() {
            let profile = JSON.parse(localStorage.getItem('arcadeProfile')) || { zCoins: 0 };
            if (profile.zCoins >= 500) {
                profile.zCoins -= 500;
                profile.isPremium = true;
                localStorage.setItem('arcadeProfile', JSON.stringify(profile));
                
                // Efecto de celebración
                const msg = document.createElement('div');
                msg.innerHTML = "<h1 style='color:#ffd700; text-shadow:0 0 20px black'>¡BIENVENIDO AL CLUB PREMIUM!</h1>";
                msg.style.cssText = "position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); display:flex; justify-content:center; align-items:center; z-index:9999; animation:fadeIn 0.5s;";
                document.body.appendChild(msg);
                
                // Confeti (usando tus partículas existentes)
                for(let i=0; i<100; i++) particles.push(new Particle());

                setTimeout(() => {
                    msg.remove();
                    updatePremiumUI();
                }, 3000);
            }
        }
    </script>
</body>
</html>